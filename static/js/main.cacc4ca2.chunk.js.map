{"version":3,"sources":["Editor.module.scss","ShareModal.module.scss","Toolbox.module.scss","Header.module.scss","InfoModal.module.scss","Header.tsx","InfoModal.tsx","pomus/catalog.ts","pomus/bg.png","pomus/0/please_wait.png","pomus/0/puffing_the_pomus.png","pomus/1/p1.png","pomus/bg2.png","pomus/pomu_loading.png","pomus/walfie_pomu_chibi_1.gif","pomus/walfie_pomu_chibi_2.gif","pomus/walfie_pomu_chibi_3.gif","pomus/walfie_pomu_chibi_4.gif","pomus/walfie_pomu_chibi_5.gif","pomus/walfie_pomu_chibi_6.gif","pomus/walfie_finana_chibi_1.gif","pomus/roamingtuna_pomu_1.gif","pomus/sumi_pomu_popcorn.gif","pomus/rinrinz_pomu_sleeping.gif","pomus/coal_pomu_sand.gif","pomus/melonbread_pomu_copter.gif","pomus/chroneco_pomu_jumping.gif","pomus/yoho_pomu_birthday.gif","pomus/sumi_pomu_jazz.gif","pomus/clairegua_pomu_duck.gif","pomus/walfie_pomu_chibi_7.gif","pomus/walfie_pomu_chibi_8.gif","pomus/coal_pomu_jumping.gif","pomus/kra_pomu_1.gif","pomus/kra_pomu_bubble_tea.gif","pomus/roamingtuna_pomu_2.gif","pomus/kelpieboye_pomu_1.gif","pomus/sumi_pomu_wavy_arms.gif","pomus/sumi_pomies.gif","pomus/sumi_pomu_pompom.gif","pomus/sumi_pomu_pomuske.gif","pomus/sumi_pomu_not_scary.gif","pomus/kayyu_pomu_pixel.gif","pomus/jameschoo_pomu_tpose.gif","pomus/kukienyan_bongos.gif","pomus/sumi_pomu_fu.gif","pomus/sumi_pomu_party.gif","PomuSerdes.ts","ShareModal.tsx","RafUtils.ts","usePomuItems.ts","Stage.tsx","Toolbox.tsx","usePomuEditor.ts","Editor.tsx","usePomuSettings.ts","usePomuToolbox.ts","ReadonlyStage.tsx","Viewer.tsx","index.tsx","Stage.module.scss"],"names":["module","exports","Header","props","audioPlaying","playAudio","pauseAudio","audioVolume","setAudioVolume","setInfoModalOpen","setShareModalOpen","className","styles","header","to","actions","onClick","volume","type","min","max","step","value","onChange","e","target","valueAsNumber","Link","children","src","href","rel","InfoModal","isOpen","setIsOpen","close","useCallback","onRequestClose","info","PomuBackground","PomuItemId","psize","w","h","POMU_ITEMS","UNKNOWN","size","source","WALFIE_POMU_CHIBI_1","walfie_pomu_chibi_1","WALFIE_POMU_CHIBI_2","walfie_pomu_chibi_2","WALFIE_POMU_CHIBI_3","walfie_pomu_chibi_3","WALFIE_POMU_CHIBI_4","walfie_pomu_chibi_4","WALFIE_POMU_CHIBI_5","walfie_pomu_chibi_5","WALFIE_POMU_CHIBI_6","walfie_pomu_chibi_6","WALFIE_FINANA_CHIBI_1","walfie_finana_chibi_1","ROAMINGTUNA_POMU_1","roamingtuna_pomu_1","SUMI_POMU_POPCORN","sumi_pomu_popcorn","RINRINZ_POMU_SLEEPING","rinrinz_pomu_sleeping","COAL_POMU_SAND","coal_pomu_sand","MELONBREAD_POMU_COPTER","melonbread_pomu_copter","CHRONECO_POMU_JUMPING","chroneco_pomu_jumping","YOHO_POMU_BIRTHDAY","yoho_pomu_birthday","SUMI_POMU_JAZZ","sumi_pomu_jazz","CLAIREGUA_POMU_DUCK","clairegua_pomu_duck","WALFIE_POMU_CHIBI_7","walfie_pomu_chibi_7","WALFIE_POMU_CHIBI_8","walfie_pomu_chibi_8","COAL_POMU_JUMPING","coal_pomu_jumping","KRA_POMU_1","kra_pomu_1","KRA_POMU_BUBBLE_TEA","kra_pomu_bubble_tea","ROAMINGTUNA_POMU_2","roamingtuna_pomu_2","KELPIEBOYE_POMU_1","kelpieboye_pomu_1","SUMI_POMU_WAVY_ARMS","sumi_pomu_wavy_arms","SUMI_POMIES","sumi_pomies","SUMI_POMU_POMPOM","sumi_pomu_pompom","SUMI_POMU_POMUSKE","sumi_pomu_pomuske","SUMI_POMU_NOT_SCARY","sumi_pomu_not_scary","KAYYU_POMU_PIXEL","kayyu_pomu_pixel","JAMESCHOO_POMU_TPOSE","jameschoo_pomu_tpose","KUKIENYAN_BONGOS","kukienyan_bongos","SUMI_POMU_FU","sumi_pomu_fu","SUMI_POMU_PARTY","sumi_pomu_party","NO_TIMELINE","gsap","core","Timeline","pct","n","ltdim","left","top","width","height","cdim","x","y","OBJECT_GROUPS_GSAP","bg","makeTimeline","style","bg_text","puffing_the_pomus","selector","tl","repeat","set","opacity","duration","position","please_wait","original_pomus","p1","rotate","t1","scaleX","add","t2","t3","t4","t5","t6","t7","t8","t9","t10","t11","t12","walfie_pomu_chibi_3b","walfie_pomu_chibis_1","bg2","pomu_loading","VERSION","floatToShort","range","Math","round","shortToFloat","parseItem","array","index","id","rotation","scale","serialize","background","items","Int16Array","flatMap","item","serializeItem","encode","buffer","deserialize","encoded","decode","length","Error","version","POMU_LOADING","parseBackground","push","ShareModal","itemsRef","useState","copyClicked","setCopyClicked","shareUrl","setShareUrl","copyLink","navigator","clipboard","writeText","setTimeout","useEffect","serialized","PomuSerdes","current","window","location","origin","pathname","share","link","cx","copied","clicked","useRefMemo","callback","ref","state","setState","lastValue","handle","running","requestAnimationFrame","loop","newValue","newState","cancelAnimationFrame","useRaf","makeBackground","CLASSIC","group","getStyles","def","transform","Stage","editorRef","editActionRef","tempItemRef","onEditStart","onEditEnd","onEditStop","deleteItem","timeline","useRef","containerRef","useSize","backgroundNodes","useMemo","itemIndex","map","object","objectIndex","domId","element","backgroundObject","alt","timelineFn","foregroundNodes","foregroundObject","onPointerDown","editNode","editAction","editKnobs","draggable","onPointerUp","corner0","corner1","corner2","corner3","delete","tempNode","tempObject","adjustedWidth","adjustedHeight","clear","node","i","domElement","document","getElementById","container","stage","foreground","Checkbox","checked","setChecked","currentTarget","Toolbox","availableItems","onDragStart","setBackground","snap","setSnap","clearAll","confirmClearAll","confirm","toolbox","options","title","itemsDrawer","touchAction","ASPECT","Editor","audio","setAudioPlaying","infoModalOpen","shareModalOpen","usePomuSettings","addItem","concat","editItem","update","console","warn","splice","usePomuItems","event","stopPropagation","preventDefault","clientX","touches","clientY","editorRect","getBoundingClientRect","onDragMove","onDragStop","right","bottom","usePomuToolbox","onDragStartToolbox","onDragMoveToolbox","onDragStopToolbox","editType","mouse","corner","translateOffset","rotated","cos","sin","angle","atan2","PI","start","scaleCorner","onEditMove","shouldSnap","shiftKey","offset","sqrt","usePomuEditor","play","pause","setInterval","paused","editor","onPointerMove","onPointerLeave","autoPlay","process","Viewer","params","useParams","main","setItems","err","POMU","ReactDOM","render","StrictMode","path"],"mappings":"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","file":"static/js/main.cacc4ca2.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"editor\":\"Editor_editor__39gwn\",\"stage\":\"Editor_stage__3sm47\",\"toolbox\":\"Editor_toolbox__3yUlo\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"share\":\"ShareModal_share__3j-ZE\",\"link\":\"ShareModal_link__1U6x1\",\"copied\":\"ShareModal_copied__2bItp\",\"clicked\":\"ShareModal_clicked__12Jf0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbox\":\"Toolbox_toolbox__2cpyu\",\"options\":\"Toolbox_options__1fYHZ\",\"itemsDrawer\":\"Toolbox_itemsDrawer__2EVPh\",\"item\":\"Toolbox_item__3Zg9W\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__34Mnk\",\"actions\":\"Header_actions__2Cfjj\",\"volume\":\"Header_volume__1wEZ2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"info\":\"InfoModal_info__2zgSl\"};","import InformationCircleIcon from \"@heroicons/react/24/outline/InformationCircleIcon\";\nimport PauseCircleIcon from \"@heroicons/react/24/outline/PauseCircleIcon\";\nimport PlayCircleIcon from \"@heroicons/react/24/outline/PlayCircleIcon\";\nimport ShareIcon from \"@heroicons/react/24/outline/ShareIcon\";\nimport { Link } from \"react-router-dom\";\n\nimport styles from \"./Header.module.scss\";\n\ninterface HeaderProps {\n  audioPlaying: boolean;\n  playAudio: () => void;\n  pauseAudio: () => void;\n  audioVolume: number;\n  setAudioVolume: (audioVolume: number) => void;\n  setInfoModalOpen: (open: boolean) => void;\n  setShareModalOpen?: (open: boolean) => void;\n}\n\nexport default function Header(props: HeaderProps): JSX.Element {\n  const {\n    audioPlaying,\n    playAudio,\n    pauseAudio,\n    audioVolume,\n    setAudioVolume,\n    setInfoModalOpen,\n    setShareModalOpen,\n  } = props;\n\n  return (\n    <div className={styles.header}>\n      <h1>\n        <Link to=\"/edit\">Build your own Pomu intro</Link>\n      </h1>\n      <div className={styles.actions}>\n        <InformationCircleIcon onClick={() => setInfoModalOpen(true)} />\n        <label>BGM&nbsp;</label>\n        {audioPlaying ? (\n          <PauseCircleIcon onClick={() => pauseAudio()} />\n        ) : (\n          <PlayCircleIcon onClick={() => playAudio()} />\n        )}\n        <label>Vol&nbsp;</label>\n        <input\n          className={styles.volume}\n          type=\"range\"\n          min={0}\n          max={1}\n          step={0.05}\n          value={audioVolume}\n          onChange={(e) => setAudioVolume(e.target.valueAsNumber)}\n        />\n        {setShareModalOpen != null ? (\n          <ShareIcon onClick={() => setShareModalOpen(true)} />\n        ) : null}\n      </div>\n    </div>\n  );\n}\n","import { ReactNode, useCallback } from \"react\";\nimport ReactModal from \"react-modal\";\n\nimport styles from \"./InfoModal.module.scss\";\n\nfunction Link(props: { children?: ReactNode; src: string }): JSX.Element {\n  const { children, src } = props;\n\n  return (\n    <a href={src} target=\"_blank\" rel=\"noreferrer\">\n      {children ?? src}\n    </a>\n  );\n}\n\nexport default function InfoModal(props: {\n  isOpen: boolean;\n  setIsOpen: (isOpen: boolean) => void;\n}): JSX.Element {\n  const { isOpen, setIsOpen } = props;\n\n  const close = useCallback((): void => setIsOpen(false), [setIsOpen]);\n\n  return (\n    <ReactModal isOpen={isOpen} onRequestClose={close} className={styles.info}>\n      <div>\n        <h1>About</h1>\n        <button onClick={close}>Close</button>\n        <hr />\n        <p>\n          Build your own{\" \"}\n          <Link src=\"https://www.nijisanji.jp/en/members/pomu-rainpuff\">\n            Pomu Rainpuff\n          </Link>{\" \"}\n          intro screen\n        </p>\n        <p>\n          Source: <Link src=\"https://github.com/enxi2/pomu\" />\n        </p>\n        <p>\n          If you would like your artwork removed, message{\" \"}\n          <Link src=\"https://discordapp.com/users/659617582298562570\">\n            enxi#0410\n          </Link>{\" \"}\n          or{\" \"}\n          <Link src=\"mailto:erin.xi@outlook.com\">erin.xi at outlook.com</Link>\n        </p>\n        <h2>Artwork and media sources</h2>\n        <ul>\n          <li>\n            <Link src=\"https://www.nijisanji.jp/en/members/pomu-rainpuff\">\n              Pomu Rainpuff\n            </Link>\n          </li>\n          <li>\n            Audio: DOVA-SYNDROME (\n            <Link src=\"https://www.youtube.com/c/DOVASYNDROMEYouTubeOfficial\">\n              YouTube\n            </Link>\n            ) -\n            <Link src=\"https://www.youtube.com/watch?v=tof9BX4lixc\">\n              逃げろ!ひつじの大群だ!\n            </Link>\n          </li>\n          <li>\n            Walfie (<Link src=\"https://twitter.com/walfieee\">@walfieee</Link>)\n          </li>\n          <li>\n            Roaming Tuna (\n            <Link src=\"https://twitter.com/RoamingTuna\">@RoamingTuna</Link>)\n          </li>\n          <li>\n            sumi (<Link src=\"https://twitter.com/suminoja\">@suminoja</Link>)\n          </li>\n          <li>\n            rinrinz (\n            <Link src=\"https://twitter.com/hikikomorinz\">@hikikomorinz</Link>)\n          </li>\n          <li>\n            Coal (<Link src=\"https://twitter.com/Coal\">@Coal</Link>)\n          </li>\n          <li>\n            Melonbread (\n            <Link src=\"https://twitter.com/MelonbreadFBP\">@MelonbreadFBP</Link>)\n          </li>\n          <li>\n            Chroneco (\n            <Link src=\"https://twitter.com/chrone_co\">@chrone_co</Link>)\n          </li>\n          <li>\n            YoHo (<Link src=\"https://twitter.com/Hyn_yoho\">@Hyn_yoho</Link>)\n          </li>\n          <li>\n            Kra (<Link src=\"https://twitter.com/Shalesa_max\">@Shalesa_max</Link>\n            )\n          </li>\n          <li>\n            KelpieBoye (\n            <Link src=\"https://twitter.com/KelpieBoye\">@KelpieBoye</Link>)\n          </li>\n          <li>\n            James Choo (\n            <Link src=\"https://twitter.com/jameschoo_004\">@jameschoo_004</Link>)\n          </li>\n          <li>\n            Kay Yu (\n            <Link src=\"https://twitter.com/kaynimatic\">@kaynimatic</Link>)\n          </li>\n          <li>\n            KukieNyan (\n            <Link src=\"https://twitter.com/Kukie_nyan\">@Kukie_nyan</Link>)\n          </li>\n          <li>\n            ClaireGua (\n            <Link src=\"https://twitter.com/Claire_ovo\">@Claire_ovo</Link>)\n          </li>\n        </ul>\n      </div>\n    </ReactModal>\n  );\n}\n","import gsap from \"gsap\";\nimport { HTMLAttributes } from \"react\";\n\nimport bg from \"./bg.png\";\nimport please_wait from \"./0/please_wait.png\";\nimport puffing_the_pomus from \"./0/puffing_the_pomus.png\";\nimport p1 from \"./1/p1.png\";\nimport bg2 from \"./bg2.png\";\nimport pomu_loading from \"./pomu_loading.png\";\n// https://twitter.com/walfieee/status/1394080386431524868\nimport walfie_pomu_chibi_1 from \"./walfie_pomu_chibi_1.gif\";\n// https://twitter.com/walfieee/status/1414435834246406150\nimport walfie_pomu_chibi_2 from \"./walfie_pomu_chibi_2.gif\";\n// https://twitter.com/walfieee/status/1408645860813119489\nimport walfie_pomu_chibi_3 from \"./walfie_pomu_chibi_3.gif\";\n// https://twitter.com/walfieee/status/1395616635327848449\nimport walfie_pomu_chibi_4 from \"./walfie_pomu_chibi_4.gif\";\n// https://twitter.com/walfieee/status/1409004073647493120\nimport walfie_pomu_chibi_5 from \"./walfie_pomu_chibi_5.gif\";\n// https://twitter.com/walfieee/status/1427020493127815170\nimport walfie_pomu_chibi_6 from \"./walfie_pomu_chibi_6.gif\";\n// https://twitter.com/walfieee/status/1407137606828187652\nimport walfie_finana_chibi_1 from \"./walfie_finana_chibi_1.gif\";\n// https://twitter.com/RoamingTuna/status/1419452403506552834\nimport roamingtuna_pomu_1 from \"./roamingtuna_pomu_1.gif\";\n// https://twitter.com/suminoja/status/1425370317740855299\nimport sumi_pomu_popcorn from \"./sumi_pomu_popcorn.gif\";\n// https://twitter.com/hikikomorinz/status/1420678509714833411\nimport rinrinz_pomu_sleeping from \"./rinrinz_pomu_sleeping.gif\";\n// https://twitter.com/Coal/status/1397011258172272642\nimport coal_pomu_sand from \"./coal_pomu_sand.gif\";\n// https://twitter.com/MelonbreadFBP/status/1405559538284064772\nimport melonbread_pomu_copter from \"./melonbread_pomu_copter.gif\";\n// https://twitter.com/chrone_co/status/1414492689286926337\nimport chroneco_pomu_jumping from \"./chroneco_pomu_jumping.gif\";\n// https://twitter.com/Hyn_yoho/status/1414194171720593414\nimport yoho_pomu_birthday from \"./yoho_pomu_birthday.gif\";\n// https://twitter.com/suminoja/status/1477525490856517632\nimport sumi_pomu_jazz from \"./sumi_pomu_jazz.gif\";\n// https://twitter.com/Claire_ovo/status/1564232056615288832\nimport clairegua_pomu_duck from \"./clairegua_pomu_duck.gif\";\n// https://twitter.com/walfieee/status/1440899906634489856\nimport walfie_pomu_chibi_7 from \"./walfie_pomu_chibi_7.gif\";\n// https://twitter.com/walfieee/status/1447773462362210306\nimport walfie_pomu_chibi_8 from \"./walfie_pomu_chibi_8.gif\";\n// https://twitter.com/Coal/status/1449841903365595140\nimport coal_pomu_jumping from \"./coal_pomu_jumping.gif\";\n// https://twitter.com/Shalesa_max/status/1460679032928833541\nimport kra_pomu_1 from \"./kra_pomu_1.gif\";\n// https://twitter.com/Shalesa_max/status/1428790208972034051\nimport kra_pomu_bubble_tea from \"./kra_pomu_bubble_tea.gif\";\n// https://twitter.com/roamingtuna/status/1432129480143691780\nimport roamingtuna_pomu_2 from \"./roamingtuna_pomu_2.gif\";\n// https://www.reddit.com/r/Nijisanji/comments/w3ucsr/\nimport kelpieboye_pomu_1 from \"./kelpieboye_pomu_1.gif\";\n// https://twitter.com/suminoja/status/1440225623352299526\nimport sumi_pomu_wavy_arms from \"./sumi_pomu_wavy_arms.gif\";\n// https://twitter.com/suminoja/status/1509006633648590849\nimport sumi_pomies from \"./sumi_pomies.gif\";\n// https://twitter.com/suminoja/status/1456542779836825603\nimport sumi_pomu_pompom from \"./sumi_pomu_pompom.gif\";\n// https://twitter.com/suminoja/status/1435122204253982722\nimport sumi_pomu_pomuske from \"./sumi_pomu_pomuske.gif\";\n// https://twitter.com/suminoja/status/1510499572203761668\nimport sumi_pomu_not_scary from \"./sumi_pomu_not_scary.gif\";\n// https://twitter.com/kaynimatic/status/1493463869368385540\nimport kayyu_pomu_pixel from \"./kayyu_pomu_pixel.gif\";\n// https://twitter.com/jameschoo_004/status/1432680740378988545\nimport jameschoo_pomu_tpose from \"./jameschoo_pomu_tpose.gif\";\n// https://twitter.com/kukie_nyan/status/1437899549998084100\nimport kukienyan_bongos from \"./kukienyan_bongos.gif\";\n// https://twitter.com/suminoja/status/1447400343151677442\nimport sumi_pomu_fu from \"./sumi_pomu_fu.gif\";\n// https://twitter.com/suminoja/status/1452185809935867904\nimport sumi_pomu_party from \"./sumi_pomu_party.gif\";\n\nexport enum PomuBackground {\n  CLASSIC = 0,\n  POMU_LOADING = 1,\n}\n\nexport enum PomuItemId {\n  UNKNOWN = 0,\n  WALFIE_POMU_CHIBI_1,\n  WALFIE_POMU_CHIBI_2,\n  WALFIE_POMU_CHIBI_3,\n  WALFIE_POMU_CHIBI_4,\n  WALFIE_POMU_CHIBI_5,\n  WALFIE_POMU_CHIBI_6,\n  WALFIE_FINANA_CHIBI_1,\n  ROAMINGTUNA_POMU_1,\n  SUMI_POMU_POPCORN,\n  RINRINZ_POMU_SLEEPING,\n  COAL_POMU_SAND,\n  MELONBREAD_POMU_COPTER,\n  CHRONECO_POMU_JUMPING,\n  YOHO_POMU_BIRTHDAY,\n  SUMI_POMU_JAZZ,\n  CLAIREGUA_POMU_DUCK,\n  WALFIE_POMU_CHIBI_7,\n  WALFIE_POMU_CHIBI_8,\n  COAL_POMU_JUMPING,\n  KRA_POMU_1,\n  KRA_POMU_BUBBLE_TEA,\n  ROAMINGTUNA_POMU_2,\n  KELPIEBOYE_POMU_1,\n  SUMI_POMU_WAVY_ARMS,\n  SUMI_POMIES,\n  SUMI_POMU_POMPOM,\n  SUMI_POMU_POMUSKE,\n  SUMI_POMU_NOT_SCARY,\n  KAYYU_POMU_PIXEL,\n  JAMESCHOO_POMU_TPOSE,\n  KUKIENYAN_BONGOS,\n  SUMI_POMU_FU,\n  SUMI_POMU_PARTY,\n}\n\nexport type PomuItemDef = {\n  src: string;\n  size: [width: number, height: number];\n  source: string;\n};\n\nfunction psize(w: number, h: number): [number, number] {\n  return [w / 1920, h / 1080];\n}\n\nexport const POMU_ITEMS: { [id in PomuItemId]: PomuItemDef } = {\n  [PomuItemId.UNKNOWN]: { src: \"\", size: [0, 0], source: \"\" },\n  [PomuItemId.WALFIE_POMU_CHIBI_1]: {\n    src: walfie_pomu_chibi_1,\n    size: psize(200, 200),\n    source: \"https://twitter.com/walfieee/status/1394080386431524868\",\n  },\n  [PomuItemId.WALFIE_POMU_CHIBI_2]: {\n    src: walfie_pomu_chibi_2,\n    size: psize(200, 200),\n    source: \"https://twitter.com/walfieee/status/1414435834246406150\",\n  },\n  [PomuItemId.WALFIE_POMU_CHIBI_3]: {\n    src: walfie_pomu_chibi_3,\n    size: psize(200, 200),\n    source: \"https://twitter.com/walfieee/status/1408645860813119489\",\n  },\n  [PomuItemId.WALFIE_POMU_CHIBI_4]: {\n    src: walfie_pomu_chibi_4,\n    size: psize(166, 200),\n    source: \"https://twitter.com/walfieee/status/1395616635327848449\",\n  },\n  [PomuItemId.WALFIE_POMU_CHIBI_5]: {\n    src: walfie_pomu_chibi_5,\n    size: psize(200, 184),\n    source: \"https://twitter.com/walfieee/status/1409004073647493120\",\n  },\n  [PomuItemId.WALFIE_POMU_CHIBI_6]: {\n    src: walfie_pomu_chibi_6,\n    size: psize(200, 200),\n    source: \"https://twitter.com/walfieee/status/1427020493127815170\",\n  },\n  [PomuItemId.WALFIE_FINANA_CHIBI_1]: {\n    src: walfie_finana_chibi_1,\n    size: psize(176, 180),\n    source: \"https://twitter.com/walfieee/status/1407137606828187652\",\n  },\n  [PomuItemId.ROAMINGTUNA_POMU_1]: {\n    src: roamingtuna_pomu_1,\n    size: psize(300, 300),\n    source: \"https://twitter.com/RoamingTuna/status/1419452403506552834\",\n  },\n  [PomuItemId.SUMI_POMU_POPCORN]: {\n    src: sumi_pomu_popcorn,\n    size: psize(300, 300),\n    source: \"https://twitter.com/suminoja/status/1425370317740855299\",\n  },\n  [PomuItemId.RINRINZ_POMU_SLEEPING]: {\n    src: rinrinz_pomu_sleeping,\n    size: psize(300, 300),\n    source: \"https://twitter.com/hikikomorinz/status/1420678509714833411\",\n  },\n  [PomuItemId.COAL_POMU_SAND]: {\n    src: coal_pomu_sand,\n    size: psize(300, 300),\n    source: \"https://twitter.com/Coal/status/1397011258172272642\",\n  },\n  [PomuItemId.MELONBREAD_POMU_COPTER]: {\n    src: melonbread_pomu_copter,\n    size: psize(300, 300),\n    source: \"https://twitter.com/MelonbreadFBP/status/1405559538284064772\",\n  },\n  [PomuItemId.CHRONECO_POMU_JUMPING]: {\n    src: chroneco_pomu_jumping,\n    size: psize(300, 300),\n    source: \"https://twitter.com/chrone_co/status/1414492689286926337\",\n  },\n  [PomuItemId.YOHO_POMU_BIRTHDAY]: {\n    src: yoho_pomu_birthday,\n    size: psize(300, 300),\n    source: \"https://twitter.com/Hyn_yoho/status/1414194171720593414\",\n  },\n  [PomuItemId.SUMI_POMU_JAZZ]: {\n    src: sumi_pomu_jazz,\n    size: psize(200, 200),\n    source: \"https://twitter.com/suminoja/status/1477525490856517632\",\n  },\n  [PomuItemId.CLAIREGUA_POMU_DUCK]: {\n    src: clairegua_pomu_duck,\n    size: psize(300, 300),\n    source: \"https://twitter.com/Claire_ovo/status/1564232056615288832\",\n  },\n  [PomuItemId.WALFIE_POMU_CHIBI_7]: {\n    src: walfie_pomu_chibi_7,\n    size: psize(200, 200),\n    source: \"https://twitter.com/walfieee/status/1440899906634489856\",\n  },\n  [PomuItemId.WALFIE_POMU_CHIBI_8]: {\n    src: walfie_pomu_chibi_8,\n    size: psize(200, 200),\n    source: \"https://twitter.com/walfieee/status/1447773462362210306\",\n  },\n  [PomuItemId.COAL_POMU_JUMPING]: {\n    src: coal_pomu_jumping,\n    size: psize(300, 300),\n    source: \"https://twitter.com/Coal/status/1449841903365595140\",\n  },\n  [PomuItemId.KRA_POMU_1]: {\n    src: kra_pomu_1,\n    size: psize(300, 300),\n    source: \"https://twitter.com/Shalesa_max/status/1460679032928833541\",\n  },\n  [PomuItemId.KRA_POMU_BUBBLE_TEA]: {\n    src: kra_pomu_bubble_tea,\n    size: psize(300, 300),\n    source: \"https://twitter.com/Shalesa_max/status/1428790208972034051\",\n  },\n  [PomuItemId.ROAMINGTUNA_POMU_2]: {\n    src: roamingtuna_pomu_2,\n    size: psize(300, 300),\n    source: \"https://twitter.com/roamingtuna/status/1432129480143691780\",\n  },\n  [PomuItemId.KELPIEBOYE_POMU_1]: {\n    src: kelpieboye_pomu_1,\n    size: psize(300, 300),\n    source: \"https://www.reddit.com/r/Nijisanji/comments/w3ucsr/\",\n  },\n  [PomuItemId.SUMI_POMU_WAVY_ARMS]: {\n    src: sumi_pomu_wavy_arms,\n    size: psize(160, 200),\n    source: \"https://twitter.com/suminoja/status/1440225623352299526\",\n  },\n  [PomuItemId.SUMI_POMIES]: {\n    src: sumi_pomies,\n    size: psize(200, 160),\n    source: \"https://twitter.com/suminoja/status/1509006633648590849\",\n  },\n  [PomuItemId.SUMI_POMU_POMPOM]: {\n    src: sumi_pomu_pompom,\n    size: psize(200, 160),\n    source: \"https://twitter.com/suminoja/status/1456542779836825603\",\n  },\n  [PomuItemId.SUMI_POMU_POMUSKE]: {\n    src: sumi_pomu_pomuske,\n    size: psize(220, 160),\n    source: \"https://twitter.com/suminoja/status/1435122204253982722\",\n  },\n  [PomuItemId.SUMI_POMU_NOT_SCARY]: {\n    src: sumi_pomu_not_scary,\n    size: psize(200, 160),\n    source: \"https://twitter.com/suminoja/status/1510499572203761668\",\n  },\n  [PomuItemId.KAYYU_POMU_PIXEL]: {\n    src: kayyu_pomu_pixel,\n    size: psize(200, 170),\n    source: \"https://twitter.com/kaynimatic/status/1493463869368385540\",\n  },\n  [PomuItemId.JAMESCHOO_POMU_TPOSE]: {\n    src: jameschoo_pomu_tpose,\n    size: psize(200, 200),\n    source: \"https://twitter.com/jameschoo_004/status/1432680740378988545\",\n  },\n  [PomuItemId.KUKIENYAN_BONGOS]: {\n    src: kukienyan_bongos,\n    size: psize(382, 300),\n    source: \"https://twitter.com/kukie_nyan/status/1437899549998084100\",\n  },\n  [PomuItemId.SUMI_POMU_FU]: {\n    src: sumi_pomu_fu,\n    size: psize(200, 160),\n    source: \"https://twitter.com/suminoja/status/1447400343151677442\",\n  },\n  [PomuItemId.SUMI_POMU_PARTY]: {\n    src: sumi_pomu_party,\n    size: psize(200, 160),\n    source: \"https://twitter.com/suminoja/status/1452185809935867904\",\n  },\n};\n\nexport type MakeTimelineFn = (selector: string) => gsap.core.Timeline;\n\nexport type AnimatedObjectGsap = {\n  src: string;\n  makeTimeline: MakeTimelineFn;\n  props?: HTMLAttributes<HTMLDivElement>;\n};\n\nexport const NO_TIMELINE = () => new gsap.core.Timeline();\n\nfunction pct(n: number): string {\n  return `${n * 100}%`;\n}\n\nfunction ltdim(\n  left: number,\n  top: number,\n  width: number,\n  height: number\n): {\n  left: string;\n  top: string;\n  width: string;\n  height: string;\n} {\n  return {\n    left: pct(left / 1920),\n    top: pct(top / 1080),\n    width: pct(width / 1920),\n    height: pct(height / 1080),\n  };\n}\n\nfunction cdim(\n  x: number,\n  y: number,\n  width: number,\n  height: number\n): {\n  left: string;\n  top: string;\n  width: string;\n  height: string;\n} {\n  return ltdim(x - width / 2, y - height / 2, width, height);\n}\n\nexport const OBJECT_GROUP_KEYS = [\n  \"bg\",\n  \"bg_text\",\n  \"original_pomus\",\n  \"walfie_pomu_chibi_1\",\n  \"walfie_pomu_chibi_2\",\n  \"walfie_pomu_chibi_3\",\n  \"walfie_finana_chibi_1\",\n  \"walfie_pomu_chibi_3b\",\n  \"walfie_pomu_chibis_1\",\n  \"bg2\",\n  \"pomu_loading\",\n] as const;\n\nexport type ObjectGroupKey = typeof OBJECT_GROUP_KEYS[number];\n\nexport type ObjectGroupGsap = ReadonlyArray<AnimatedObjectGsap>;\n\nexport const OBJECT_GROUPS_GSAP: { [key in ObjectGroupKey]: ObjectGroupGsap } =\n  {\n    // Background\n    bg: [\n      {\n        src: bg,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...ltdim(0, 0, 1920, 1080),\n          },\n        },\n      },\n    ],\n    // Base text animated on the background\n    bg_text: [\n      {\n        src: puffing_the_pomus,\n        makeTimeline: (selector: string): gsap.core.Timeline => {\n          const tl = new gsap.core.Timeline({ repeat: -1 });\n          tl.set(selector, { opacity: 0 });\n          tl.to(selector, { opacity: 1, duration: 1 }, 0);\n          tl.to(selector, { opacity: 0, duration: 1 }, 3.5);\n          tl.set(selector, {}, 10);\n          return tl;\n        },\n        props: {\n          style: {\n            position: \"absolute\",\n            left: \"0%\",\n            top: \"0%\",\n            width: \"100%\",\n            height: \"100%\",\n          },\n        },\n      },\n      {\n        src: please_wait,\n        makeTimeline: (selector: string): gsap.core.Timeline => {\n          const tl = new gsap.core.Timeline({ repeat: -1 });\n          tl.set(selector, { opacity: 0 });\n          tl.to(selector, { opacity: 1, duration: 1 }, 5.5);\n          tl.to(selector, { opacity: 0, duration: 1 }, 9);\n          return tl;\n        },\n        props: {\n          style: {\n            position: \"absolute\",\n            left: \"0%\",\n            top: \"0%\",\n            width: \"100%\",\n            height: \"100%\",\n          },\n        },\n      },\n    ],\n    // Original pomus since the debut stream\n    // https://www.youtube.com/watch?v=e0KSfSf7BuQ\n    original_pomus: [\n      {\n        src: p1,\n        makeTimeline: (selector: string): gsap.core.Timeline => {\n          const tl = new gsap.core.Timeline({ repeat: -1 });\n          tl.set(selector, { rotate: \"-15deg\" });\n          tl.set(selector, { rotate: \"15deg\" }, 0.6);\n          tl.set(selector, {}, 1.2);\n          return tl;\n        },\n        props: {\n          style: {\n            ...cdim(328, 698, 508, 699),\n          },\n        },\n      },\n      {\n        src: p1,\n        makeTimeline: (selector: string): gsap.core.Timeline => {\n          const tl = new gsap.core.Timeline({ repeat: -1 });\n\n          const t1 = new gsap.core.Timeline({ repeat: 3 });\n          t1.set(selector, {\n            ...cdim(1170, 1188, 508, 699),\n            scaleX: -1,\n            rotate: \"165deg\",\n          });\n          t1.set(selector, { rotate: \"-165deg\" }, 0.6);\n          t1.set(selector, {}, 1.2);\n          tl.add(t1);\n\n          const t2 = new gsap.core.Timeline({ repeat: 3 });\n          t2.set(selector, {\n            ...cdim(1809, 498, 508, 699),\n            scaleX: 1,\n            rotate: \"-65deg\",\n          });\n          t2.set(selector, { rotate: \"-115deg\" }, 0.6);\n          t2.set(selector, {}, 1.2);\n          tl.add(t2);\n\n          const t3 = new gsap.core.Timeline();\n          t3.set(selector, {\n            ...cdim(730, 703, 508, 699),\n            scaleX: -1,\n            rotate: \"165deg\",\n          });\n          t3.set(selector, { rotate: \"-165deg\" }, 0.6);\n          t3.set(selector, { rotate: \"165deg\" }, 1.2);\n          t3.set(selector, {}, 1.8);\n          tl.add(t3);\n\n          const t4 = new gsap.core.Timeline({ repeat: 1 });\n          t4.set(selector, {\n            ...cdim(480, 58, 508, 699),\n            scaleX: -1,\n            rotate: \"-165deg\",\n          });\n          t4.set(selector, { rotate: \"165deg\" }, 0.6);\n          t4.set(selector, {}, 1.2);\n          tl.add(t4);\n\n          const t5 = new gsap.core.Timeline();\n          t5.set(selector, {\n            ...cdim(1495, 125, 508, 699),\n            scaleX: -1,\n            rotate: \"-165deg\",\n          });\n          t5.set(selector, { rotate: \"165deg\" }, 0.6);\n          t5.set(selector, { rotate: \"-165deg\" }, 1.2);\n          t5.set(selector, { rotate: \"165deg\" }, 1.8);\n          t5.set(selector, { rotate: \"-165deg\" }, 2.4);\n          t5.set(selector, {}, 3.0);\n          tl.add(t5);\n\n          const t6 = new gsap.core.Timeline();\n          t6.set(selector, {\n            ...cdim(125, -30, 508, 699),\n            scaleX: -1,\n            rotate: \"165deg \",\n          });\n          t6.set(selector, { rotate: \"-165deg\" }, 0.6);\n          t6.set(selector, { rotate: \"165deg\" }, 1.2);\n          t6.set(selector, { rotate: \"-165deg\" }, 1.8);\n          t6.set(selector, { rotate: \"165deg\" }, 2.4);\n          t6.set(selector, {}, 3.0);\n          tl.add(t6);\n\n          const t7 = new gsap.core.Timeline();\n          t7.set(selector, {\n            ...cdim(1247, 1227, 1533, 2109),\n            scaleX: 1,\n            rotate: \"15deg \",\n          });\n          t7.set(selector, { rotate: \"-15deg\" }, 0.6);\n          t7.set(selector, { rotate: \"15deg\" }, 1.2);\n          t7.set(selector, { rotate: \"-15deg\" }, 1.8);\n          t7.set(selector, { rotate: \"15deg\" }, 2.4);\n          t7.set(selector, { rotate: \"-15deg\" }, 3.0);\n          t7.set(selector, { rotate: \"15deg\" }, 3.6);\n          t7.set(selector, {}, 4.2);\n          tl.add(t7);\n\n          const t8 = new gsap.core.Timeline();\n          t8.set(selector, {\n            ...cdim(1017, 519, 508, 699),\n            scaleX: -1,\n            rotate: \"165deg\",\n          });\n          t8.set(selector, { rotate: \"-165deg\" }, 0.6);\n          t8.set(selector, { rotate: \"165deg\" }, 1.2);\n          t8.set(selector, {}, 1.8);\n          tl.add(t8);\n\n          const t9 = new gsap.core.Timeline({ repeat: 6 });\n          t9.set(selector, {\n            ...cdim(1495, 125, 508, 699),\n            scaleX: -1,\n            rotate: \"-165deg\",\n          });\n          t9.set(selector, { rotate: \"165deg\" }, 0.6);\n          t9.set(selector, {}, 1.2);\n          tl.add(t9);\n\n          const t10 = new gsap.core.Timeline();\n          t10.set(selector, { rotate: \"-165deg\" });\n          t10.set(selector, {}, 0.6);\n          tl.add(t10);\n\n          const t11 = new gsap.core.Timeline();\n          t11.set(selector, {\n            ...cdim(332, 124, 508, 699),\n            scaleX: -1,\n            rotate: \"165deg\",\n          });\n          t11.set(selector, { rotate: \"-165deg\" }, 0.6);\n          t11.set(selector, { rotate: \"165deg\" }, 1.2);\n          t11.set(selector, {}, 1.8);\n          tl.add(t11);\n\n          const t12 = new gsap.core.Timeline();\n          t12.set(selector, {\n            ...cdim(329, 703, 508, 699),\n            scaleX: -1,\n            rotate: \"-165deg\",\n          });\n          t12.set(selector, { rotate: \"165deg\" }, 0.6);\n          t12.set(selector, { rotate: \"-165deg\" }, 1.2);\n          t12.set(selector, {}, 1.8);\n          tl.add(t12);\n\n          return tl;\n        },\n        props: {\n          style: {},\n        },\n      },\n    ],\n    // Chibi Pomu from @walfieee\n    // https://twitter.com/walfieee/status/1394080386431524868\n    // https://www.youtube.com/watch?v=FgoO57-TGkM\n    walfie_pomu_chibi_1: [\n      {\n        src: walfie_pomu_chibi_1,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...ltdim(1343, 548, 576, 576),\n          },\n        },\n      },\n    ],\n    // Birthday chibi Pomu\n    // https://twitter.com/walfieee/status/1414435834246406150\n    walfie_pomu_chibi_2: [\n      {\n        src: walfie_pomu_chibi_2,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...ltdim(1348, 536, 544, 544),\n          },\n        },\n      },\n    ],\n    // Money tossing chibi Pomu\n    walfie_pomu_chibi_3: [\n      {\n        src: walfie_pomu_chibi_3,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...ltdim(987, 469, 568, 568),\n          },\n        },\n      },\n    ],\n    // Birthday chips eating chibi Finana\n    walfie_finana_chibi_1: [\n      {\n        src: walfie_finana_chibi_1,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...ltdim(687, 599, 440, 450),\n          },\n        },\n      },\n    ],\n    // Money tossing chibi Pomu but in the bottom right\n    walfie_pomu_chibi_3b: [\n      {\n        src: walfie_pomu_chibi_3,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...ltdim(1352, 512, 567, 567),\n          },\n        },\n      },\n    ],\n    // A bunch of chibi Pomus\n    walfie_pomu_chibis_1: [\n      {\n        src: walfie_pomu_chibi_3,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...cdim(670, 384, 204, 204),\n          },\n        },\n      },\n      {\n        src: walfie_pomu_chibi_1,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...cdim(831, 395, 184, 184),\n          },\n        },\n      },\n      {\n        src: walfie_pomu_chibi_2,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...cdim(991, 384, 183, 183),\n          },\n        },\n      },\n      {\n        src: walfie_pomu_chibi_4,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...cdim(1140, 391, 153, 184),\n          },\n        },\n      },\n      {\n        src: walfie_pomu_chibi_5,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...cdim(1282, 394, 184, 169),\n          },\n        },\n      },\n      {\n        src: walfie_pomu_chibi_6,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...cdim(1466, 399, 179, 179),\n          },\n        },\n      },\n    ],\n    // Assorted other animated Pomus\n    // https://twitter.com/RoamingTuna/status/1419452403506552834\n    // https://twitter.com/suminoja/status/1425370317740855299\n    // https://twitter.com/hikikomorinz/status/1420678509714833411\n    // https://twitter.com/Coal/status/1396994013576634368\n    // https://twitter.com/MelonbreadFBP/status/1405559538284064772\n    // https://twitter.com/chrone_co/status/1414492689286926337\n    // https://twitter.com/Hyn_yoho/status/1414194171720593414\n    // Background\n    bg2: [\n      {\n        src: bg2,\n        makeTimeline: NO_TIMELINE,\n        props: {\n          style: {\n            ...ltdim(0, 0, 1920, 1080),\n          },\n        },\n      },\n    ],\n    pomu_loading: [\n      {\n        src: pomu_loading,\n        makeTimeline: (selector: string): gsap.core.Timeline => {\n          const tl = new gsap.core.Timeline({ repeat: -1 });\n          tl.set(selector, { opacity: 0 });\n          tl.to(selector, { opacity: 1, duration: 1 }, 0);\n          tl.to(selector, { opacity: 0, duration: 1 }, 3.5);\n          tl.set(selector, {}, 5);\n          return tl;\n        },\n        props: {\n          style: {\n            ...ltdim(0, 0, 1920, 1080),\n          },\n        },\n      },\n    ],\n  };\n\nexport const VERSIONS: ReadonlyArray<ReadonlyArray<ObjectGroupKey>> = [\n  // Version 0, base bg text\n  [\"bg_text\"],\n  // Version 1, original pomus since debut stream\n  // https://www.youtube.com/watch?v=e0KSfSf7BuQ\n  [\"bg_text\", \"original_pomus\"],\n  // Version 2, with chibi Pomu\n  // https://www.youtube.com/watch?v=FgoO57-TGkM\n  [\"bg_text\", \"original_pomus\", \"walfie_pomu_chibi_1\"],\n  // Version 3, with birthday chibi Pomu\n  // https://www.youtube.com/watch?v=XsbJK2pINv0\n  // TODO: separate birthday stream version?\n  // https://www.youtube.com/watch?v=4vrD9dHHwao\n  [\"bg_text\", \"original_pomus\", \"walfie_pomu_chibi_2\"],\n  // With chibi Finana and chibi money Pomu\n  // https://www.youtube.com/watch?v=8zUb1CGCnZ0\n  [\"bg_text\", \"original_pomus\", \"walfie_pomu_chibi_3\", \"walfie_finana_chibi_1\"],\n  // Without Finana and chibi moved\n  // https://www.youtube.com/watch?v=ZRb4HsiQXc8\n  [\"bg_text\", \"original_pomus\", \"walfie_pomu_chibi_3b\"],\n  // Oh man it exploded\n  // https://www.youtube.com/watch?v=QE7uuTEezR0\n  [\"bg_text\", \"original_pomus\", \"walfie_pomu_chibis_1\"],\n  // Things adjusted\n  // https://www.youtube.com/watch?v=8_VeRNE7LhQ\n  // TODO\n  // Added one, readjusted one\n  // https://www.youtube.com/watch?v=944mNPsSu6Y\n  // TODO\n  // Added one, adjustments\n  // https://www.youtube.com/watch?v=gTPZMgQ-CRM\n  // TODO\n];\n","export default __webpack_public_path__ + \"static/media/bg.555142f0.png\";","export default __webpack_public_path__ + \"static/media/please_wait.cf6a42fc.png\";","export default __webpack_public_path__ + \"static/media/puffing_the_pomus.7cf6e691.png\";","export default __webpack_public_path__ + \"static/media/p1.26538280.png\";","export default __webpack_public_path__ + \"static/media/bg2.f695abf2.png\";","export default __webpack_public_path__ + \"static/media/pomu_loading.c4745963.png\";","export default __webpack_public_path__ + \"static/media/walfie_pomu_chibi_1.e61780b0.gif\";","export default __webpack_public_path__ + \"static/media/walfie_pomu_chibi_2.843b2ae8.gif\";","export default __webpack_public_path__ + \"static/media/walfie_pomu_chibi_3.b8e44366.gif\";","export default __webpack_public_path__ + \"static/media/walfie_pomu_chibi_4.4c767a26.gif\";","export default __webpack_public_path__ + \"static/media/walfie_pomu_chibi_5.dacf4060.gif\";","export default __webpack_public_path__ + \"static/media/walfie_pomu_chibi_6.dee66815.gif\";","export default __webpack_public_path__ + \"static/media/walfie_finana_chibi_1.854b00b6.gif\";","export default __webpack_public_path__ + \"static/media/roamingtuna_pomu_1.034cda3d.gif\";","export default __webpack_public_path__ + \"static/media/sumi_pomu_popcorn.fc4710c4.gif\";","export default __webpack_public_path__ + \"static/media/rinrinz_pomu_sleeping.b7698e91.gif\";","export default __webpack_public_path__ + \"static/media/coal_pomu_sand.70de2997.gif\";","export default __webpack_public_path__ + \"static/media/melonbread_pomu_copter.ab5a90a5.gif\";","export default __webpack_public_path__ + \"static/media/chroneco_pomu_jumping.482a5be2.gif\";","export default __webpack_public_path__ + \"static/media/yoho_pomu_birthday.6a388d31.gif\";","export default __webpack_public_path__ + \"static/media/sumi_pomu_jazz.f7237d05.gif\";","export default __webpack_public_path__ + \"static/media/clairegua_pomu_duck.648978de.gif\";","export default __webpack_public_path__ + \"static/media/walfie_pomu_chibi_7.c7c0dcd2.gif\";","export default __webpack_public_path__ + \"static/media/walfie_pomu_chibi_8.9c43e482.gif\";","export default __webpack_public_path__ + \"static/media/coal_pomu_jumping.4be9fcd9.gif\";","export default __webpack_public_path__ + \"static/media/kra_pomu_1.60c3130b.gif\";","export default __webpack_public_path__ + \"static/media/kra_pomu_bubble_tea.cf187a3e.gif\";","export default __webpack_public_path__ + \"static/media/roamingtuna_pomu_2.fee639d5.gif\";","export default __webpack_public_path__ + \"static/media/kelpieboye_pomu_1.33cad85f.gif\";","export default __webpack_public_path__ + \"static/media/sumi_pomu_wavy_arms.eb59e0a7.gif\";","export default __webpack_public_path__ + \"static/media/sumi_pomies.ee995c4d.gif\";","export default __webpack_public_path__ + \"static/media/sumi_pomu_pompom.0faf8130.gif\";","export default __webpack_public_path__ + \"static/media/sumi_pomu_pomuske.5cca8c3f.gif\";","export default __webpack_public_path__ + \"static/media/sumi_pomu_not_scary.536eb25a.gif\";","export default __webpack_public_path__ + \"static/media/kayyu_pomu_pixel.4ad1f864.gif\";","export default __webpack_public_path__ + \"static/media/jameschoo_pomu_tpose.1a924d9e.gif\";","export default __webpack_public_path__ + \"static/media/kukienyan_bongos.d20da9d8.gif\";","export default __webpack_public_path__ + \"static/media/sumi_pomu_fu.6d782459.gif\";","export default __webpack_public_path__ + \"static/media/sumi_pomu_party.b71a7e25.gif\";","import { encode, decode } from \"base64-arraybuffer\";\n\nimport { PomuBackground } from \"./pomus/catalog\";\nimport { PomuItem } from \"./usePomuItems\";\n\nconst VERSION = 1;\n\nfunction floatToShort(range: number, x: number): number {\n  const short = Math.round(\n    (Math.max(Math.min(x, range), -range) * 32767) / range\n  );\n  return short;\n}\n\nfunction shortToFloat(range: number, x: number): number {\n  return (x * range) / 32767;\n}\n\nfunction parseBackground(x: number): PomuBackground {\n  if (x < 0 || x > PomuBackground.POMU_LOADING) {\n    throw new Error(`Unknown background ${x}`);\n  }\n  return x as PomuBackground;\n}\n\nfunction serializeItem(item: PomuItem): number[] {\n  return [\n    item.id,\n    floatToShort(2, item.position[0]),\n    floatToShort(2, item.position[1]),\n    floatToShort(7, item.rotation),\n    floatToShort(20, item.scale),\n  ];\n}\n\nfunction parseItem(array: Int16Array, index: number): PomuItem {\n  return {\n    id: array[index + 0],\n    position: [\n      shortToFloat(2, array[index + 1]),\n      shortToFloat(2, array[index + 2]),\n    ],\n    rotation: shortToFloat(7, array[index + 3]),\n    scale: shortToFloat(20, array[index + 4]),\n  };\n}\n\nexport function serialize(\n  background: PomuBackground,\n  items: PomuItem[]\n): string {\n  const array = new Int16Array([\n    VERSION,\n    background,\n    ...items.flatMap((item) => serializeItem(item)),\n  ]);\n  return encode(array.buffer);\n}\nexport function deserialize(encoded: string): {\n  background: PomuBackground;\n  items: PomuItem[];\n} {\n  const buffer = decode(encoded);\n  const array = new Int16Array(buffer);\n  if (array.length < 2) {\n    throw new Error(\"No data\");\n  }\n  const version = array[0];\n  if (version !== VERSION) {\n    throw new Error(`Unsupported version ${version}`);\n  }\n  const background = parseBackground(array[1]);\n\n  const items: PomuItem[] = [];\n  let index = 2;\n  while (index + 4 < array.length) {\n    items.push(parseItem(array, index));\n    index += 5;\n  }\n  return { background, items };\n}\n","import ClipboardDocument from \"@heroicons/react/24/outline/ClipboardDocumentIcon\";\nimport cx from \"classnames\";\nimport { MutableRefObject, useCallback, useEffect, useState } from \"react\";\nimport ReactModal from \"react-modal\";\n\nimport { PomuBackground } from \"./pomus/catalog\";\nimport * as PomuSerdes from \"./PomuSerdes\";\nimport { PomuItem } from \"./usePomuItems\";\n\nimport styles from \"./ShareModal.module.scss\";\n\nexport default function ShareModal(props: {\n  isOpen: boolean;\n  setIsOpen: (isOpen: boolean) => void;\n  background: PomuBackground;\n  itemsRef: MutableRefObject<PomuItem[]>;\n}): JSX.Element {\n  const { isOpen, setIsOpen, background, itemsRef } = props;\n\n  const [copyClicked, setCopyClicked] = useState<boolean>(false);\n  const [shareUrl, setShareUrl] = useState<string>(\"\");\n\n  const close = useCallback((): void => setIsOpen(false), [setIsOpen]);\n\n  const copyLink = useCallback(() => {\n    navigator.clipboard.writeText(shareUrl);\n    setCopyClicked(true);\n    setTimeout(() => setCopyClicked(false), 1000);\n  }, [shareUrl]);\n\n  useEffect(() => {\n    if (isOpen) {\n      const serialized = PomuSerdes.serialize(background, itemsRef.current);\n      setShareUrl(\n        `${window.location.origin}${window.location.pathname}#/view/${serialized}`\n      );\n    }\n  }, [isOpen, background, itemsRef]);\n\n  return (\n    <ReactModal isOpen={isOpen} onRequestClose={close} className={styles.share}>\n      <div>\n        <h1>Share</h1>\n        <button onClick={close}>Close</button>\n        <div className={styles.link}>\n          <a href={shareUrl} target=\"_blank\" rel=\"noreferrer\">\n            {shareUrl}\n          </a>\n          <ClipboardDocument onClick={copyLink} />\n        </div>\n        <div className={cx(styles.copied, copyClicked ? styles.clicked : null)}>\n          Copied!\n        </div>\n      </div>\n    </ReactModal>\n  );\n}\n","import { MutableRefObject, useEffect, useState } from \"react\";\n\nexport function useRefMemo<T, U>(\n  callback: (value: T) => U,\n  ref: MutableRefObject<T>\n): U {\n  const [state, setState] = useState<U>(() => callback(ref.current));\n\n  useEffect(() => {\n    let lastValue = ref.current;\n    setState(callback(lastValue));\n    let handle = -1;\n    let running = true;\n\n    const loop = () => {\n      if (!running) {\n        return;\n      }\n      handle = requestAnimationFrame(loop);\n\n      const newValue = ref.current;\n      if (newValue !== lastValue) {\n        const newState = callback(newValue);\n        lastValue = newValue;\n        setState(newState);\n      }\n    };\n\n    handle = requestAnimationFrame(loop);\n\n    return () => {\n      cancelAnimationFrame(handle);\n      running = false;\n    };\n  }, [callback, ref]);\n\n  return state;\n}\n\nexport function useRaf(callback: () => void): void {\n  useEffect(() => {\n    let handle = -1;\n    let running = true;\n\n    const loop = () => {\n      if (!running) {\n        return;\n      }\n      handle = requestAnimationFrame(loop);\n      callback();\n    };\n\n    loop();\n\n    return () => {\n      cancelAnimationFrame(handle);\n      running = false;\n    };\n  }, [callback]);\n}\n","import { MutableRefObject, useCallback, useMemo, useRef } from \"react\";\n\nimport {\n  ObjectGroupGsap,\n  OBJECT_GROUPS_GSAP,\n  PomuBackground,\n  PomuItemId,\n} from \"./pomus/catalog\";\n\nexport type PomuBackgroundItem = {\n  group: ObjectGroupGsap;\n  position: [u: number, v: number];\n};\n\nexport function makeBackground(\n  background: PomuBackground\n): PomuBackgroundItem[] {\n  switch (background) {\n    case PomuBackground.CLASSIC:\n      return [\n        { group: OBJECT_GROUPS_GSAP[\"bg\"], position: [0, 0] },\n        { group: OBJECT_GROUPS_GSAP[\"bg_text\"], position: [0, 0] },\n        { group: OBJECT_GROUPS_GSAP[\"original_pomus\"], position: [0, 0] },\n      ];\n    case PomuBackground.POMU_LOADING:\n      return [\n        { group: OBJECT_GROUPS_GSAP[\"bg2\"], position: [0, 0] },\n        { group: OBJECT_GROUPS_GSAP[\"pomu_loading\"], position: [0, 0] },\n      ];\n  }\n}\n\nexport type PomuItem = {\n  id: PomuItemId;\n  position: [u: number, v: number];\n  rotation: number;\n  scale: number;\n};\n\n// TODO initialItems parameter\nexport default function usePomuItems(): {\n  itemsRef: MutableRefObject<PomuItem[]>;\n  availableItems: PomuItemId[];\n  addItem: (item: PomuItem) => void;\n  editItem: (index: number, update: Partial<PomuItem>) => void;\n  deleteItem: (index: number) => void;\n  clearAll: () => void;\n} {\n  const itemsRef = useRef<PomuItem[]>([]);\n\n  const availableItems = useMemo(\n    (): PomuItemId[] => [\n      PomuItemId.WALFIE_POMU_CHIBI_1,\n      PomuItemId.WALFIE_POMU_CHIBI_2,\n      PomuItemId.WALFIE_POMU_CHIBI_3,\n      PomuItemId.WALFIE_POMU_CHIBI_4,\n      PomuItemId.WALFIE_POMU_CHIBI_5,\n      PomuItemId.WALFIE_POMU_CHIBI_6,\n      PomuItemId.WALFIE_FINANA_CHIBI_1,\n      PomuItemId.ROAMINGTUNA_POMU_1,\n      PomuItemId.SUMI_POMU_POPCORN,\n      PomuItemId.RINRINZ_POMU_SLEEPING,\n      PomuItemId.COAL_POMU_SAND,\n      PomuItemId.MELONBREAD_POMU_COPTER,\n      PomuItemId.CHRONECO_POMU_JUMPING,\n      PomuItemId.SUMI_POMU_JAZZ,\n      PomuItemId.CLAIREGUA_POMU_DUCK,\n      PomuItemId.WALFIE_POMU_CHIBI_7,\n      PomuItemId.WALFIE_POMU_CHIBI_8,\n      PomuItemId.COAL_POMU_JUMPING,\n      PomuItemId.KRA_POMU_1,\n      PomuItemId.KRA_POMU_BUBBLE_TEA,\n      PomuItemId.ROAMINGTUNA_POMU_2,\n      PomuItemId.KELPIEBOYE_POMU_1,\n      PomuItemId.SUMI_POMU_WAVY_ARMS,\n      PomuItemId.SUMI_POMIES,\n      PomuItemId.SUMI_POMU_POMPOM,\n      PomuItemId.SUMI_POMU_POMUSKE,\n      PomuItemId.SUMI_POMU_NOT_SCARY,\n      PomuItemId.KAYYU_POMU_PIXEL,\n      PomuItemId.JAMESCHOO_POMU_TPOSE,\n      PomuItemId.KUKIENYAN_BONGOS,\n      PomuItemId.SUMI_POMU_FU,\n      PomuItemId.SUMI_POMU_PARTY,\n    ],\n    []\n  );\n\n  const addItem = useCallback((item: PomuItem) => {\n    itemsRef.current = itemsRef.current.concat([item]);\n  }, []);\n\n  const editItem = useCallback((index: number, update: Partial<PomuItem>) => {\n    const item = itemsRef.current[index];\n    if (item == null) {\n      console.warn(`Cannot move: unknown index (index=${index})`);\n      return;\n    }\n\n    if (update.position != null) {\n      item.position = update.position;\n    }\n    if (update.rotation != null) {\n      item.rotation = update.rotation;\n    }\n    if (update.scale != null) {\n      item.scale = update.scale;\n    }\n  }, []);\n\n  const deleteItem = useCallback((index: number) => {\n    itemsRef.current.splice(index, 1);\n    itemsRef.current = [...itemsRef.current];\n  }, []);\n\n  const clearAll = useCallback(() => {\n    itemsRef.current = [];\n  }, []);\n\n  return {\n    itemsRef,\n    availableItems,\n    addItem,\n    editItem,\n    deleteItem,\n    clearAll,\n  };\n}\n","import TrashIcon from \"@heroicons/react/24/outline/TrashIcon\";\nimport useSize from \"@react-hook/size\";\nimport cx from \"classnames\";\nimport gsap from \"gsap\";\nimport {\n  MutableRefObject,\n  RefObject,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n} from \"react\";\n\nimport { MakeTimelineFn, PomuBackground, POMU_ITEMS } from \"./pomus/catalog\";\nimport { useRaf, useRefMemo } from \"./RafUtils\";\nimport { PomuEditAction, PomuEditType } from \"./usePomuEditor\";\nimport { makeBackground, PomuItem } from \"./usePomuItems\";\nimport { CursorEvent } from \"./types\";\n\nimport styles from \"./Stage.module.scss\";\n\nfunction getStyles(item: PomuItem): Record<string, string> {\n  const def = POMU_ITEMS[item.id];\n  return {\n    width: `${def.size[0] * item.scale * 100}%`,\n    height: `${def.size[1] * item.scale * 100}%`,\n    left: `${item.position[0] * 100}%`,\n    top: `${item.position[1] * 100}%`,\n    transform: `translate(-50%, -50%) rotate(${item.rotation}rad)`,\n  };\n}\n\ntype RenderedNode = {\n  domId: string;\n  element: JSX.Element;\n  timelineFn: MakeTimelineFn | null;\n};\n\ninterface StageProps {\n  editorRef: RefObject<HTMLDivElement>;\n  background: PomuBackground;\n  itemsRef: MutableRefObject<PomuItem[]>;\n  editActionRef: MutableRefObject<PomuEditAction | null>;\n  tempItemRef: MutableRefObject<PomuItem | null>;\n  onEditStart: (\n    event: CursorEvent<HTMLElement>,\n    index: number,\n    editType: PomuEditType\n  ) => void;\n  onEditEnd: (event: CursorEvent<HTMLElement>) => void;\n  onEditStop: (event: CursorEvent<HTMLElement>) => void;\n  deleteItem: (index: number) => void;\n}\n\nexport default function Stage(props: StageProps): JSX.Element {\n  const {\n    editorRef,\n    background,\n    itemsRef,\n    editActionRef,\n    tempItemRef,\n    onEditStart,\n    onEditEnd,\n    onEditStop,\n    deleteItem,\n  } = props;\n\n  const timeline = useRef<gsap.core.Timeline>(new gsap.core.Timeline());\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const [width, height] = useSize(containerRef);\n\n  const backgroundNodes = useMemo((): RenderedNode[] => {\n    const bgItems = makeBackground(background);\n\n    return bgItems.flatMap((item, itemIndex) => {\n      return item.group.map((object, objectIndex) => {\n        const id = `bg-${itemIndex}-${objectIndex}`;\n        return {\n          domId: id,\n          element: (\n            <div\n              key={id}\n              id={id}\n              className={styles.backgroundObject}\n              {...object.props}\n            >\n              <img src={object.src} alt=\"Pomu\" />\n            </div>\n          ),\n          timelineFn: object.makeTimeline,\n        };\n      });\n    });\n  }, [background]);\n\n  const foregroundNodes = useRefMemo(\n    useCallback(\n      (items: PomuItem[]): RenderedNode[] => {\n        return items.flatMap((item, itemIndex) => {\n          const id: string = `fg-${itemIndex}`;\n          return {\n            domId: id,\n            element: (\n              <div\n                key={id}\n                id={id}\n                className={styles.foregroundObject}\n                style={{ ...getStyles(item) }}\n                onPointerDown={(e) => {\n                  onEditStart(e, itemIndex, \"translate\");\n                }}\n              >\n                <img src={POMU_ITEMS[item.id].src} alt=\"Pomu\" />\n              </div>\n            ),\n            timelineFn: null,\n          };\n        });\n      },\n      [onEditStart]\n    ),\n    itemsRef\n  );\n\n  const editNode = useRefMemo(\n    useCallback(\n      (editAction: PomuEditAction | null): JSX.Element | null => {\n        if (editAction == null) {\n          return null;\n        }\n\n        const item = itemsRef.current[editAction.index];\n        if (item == null) {\n          return null;\n        }\n\n        const id = \"edit\";\n        return (\n          <div\n            key={id}\n            id={id}\n            className={cx(styles.editKnobs, styles.draggable)}\n            style={{ ...getStyles(item) }}\n            onPointerDown={(e) => {\n              onEditStart(e, editAction.index, \"translate\");\n            }}\n            onPointerUp={onEditEnd}\n          >\n            <div\n              className={cx(styles.scale, styles.corner0, styles.draggable)}\n              onPointerDown={(e) => onEditStart(e, editAction.index, \"scale\")}\n            ></div>\n            <div\n              className={cx(styles.scale, styles.corner1, styles.draggable)}\n              onPointerDown={(e) => onEditStart(e, editAction.index, \"scale\")}\n            ></div>\n            <div\n              className={cx(styles.scale, styles.corner2, styles.draggable)}\n              onPointerDown={(e) => onEditStart(e, editAction.index, \"scale\")}\n            ></div>\n            <div\n              className={cx(styles.scale, styles.corner3, styles.draggable)}\n              onPointerDown={(e) => onEditStart(e, editAction.index, \"scale\")}\n            ></div>\n            <div\n              className={cx(styles.delete)}\n              onPointerDown={(e) => {\n                deleteItem(editAction.index);\n                onEditStop(e);\n              }}\n            >\n              <TrashIcon />\n            </div>\n          </div>\n        );\n      },\n      [itemsRef, onEditStart, onEditEnd, onEditStop, deleteItem]\n    ),\n    editActionRef\n  );\n\n  const tempNode = useRefMemo(\n    useCallback((item: PomuItem | null): RenderedNode | null => {\n      if (item == null) {\n        return null;\n      }\n      const id = \"temp\";\n      return {\n        domId: id,\n        element: (\n          <div\n            key={id}\n            id={id}\n            className={styles.tempObject}\n            style={{ ...getStyles(item) }}\n          >\n            <img src={POMU_ITEMS[item.id].src} alt=\"Pomu\" />\n          </div>\n        ),\n        timelineFn: null,\n      };\n    }, []),\n    tempItemRef\n  );\n\n  const [adjustedWidth, adjustedHeight] = useMemo(() => {\n    if (width / height > 16 / 9) {\n      return [(height * 16) / 9, height];\n    } else {\n      return [width, (width * 9) / 16];\n    }\n  }, [width, height]);\n\n  useEffect(() => {\n    timeline.current.clear();\n    for (const node of backgroundNodes) {\n      if (node.timelineFn != null) {\n        timeline.current.add(node.timelineFn(`#${node.domId}`), 0);\n      }\n    }\n    for (const node of foregroundNodes) {\n      if (node.timelineFn != null) {\n        timeline.current.add(node.timelineFn(`#${node.domId}`), 0);\n      }\n    }\n  }, [backgroundNodes, foregroundNodes]);\n\n  // Foreground nodes\n  useRaf(\n    useCallback(() => {\n      for (let i = 0; i < itemsRef.current.length; i++) {\n        const item = itemsRef.current[i];\n        const node = foregroundNodes[i];\n        if (item == null || node == null) {\n          continue;\n        }\n        const domElement = document.getElementById(node.domId);\n        if (domElement == null) {\n          continue;\n        }\n\n        const styles = getStyles(item);\n        for (const style in styles) {\n          (domElement.style as any)[style] = styles[style];\n        }\n      }\n    }, [foregroundNodes, itemsRef])\n  );\n\n  // Edit node when modifying objects\n  useRaf(\n    useCallback(() => {\n      if (editActionRef.current == null) {\n        return;\n      }\n      const item = itemsRef.current[editActionRef.current.index];\n      if (item == null) {\n        return;\n      }\n      const domElement = document.getElementById(\"edit\");\n      if (domElement == null) {\n        return;\n      }\n\n      const styles = getStyles(item);\n      for (const style in styles) {\n        (domElement.style as any)[style] = styles[style];\n      }\n    }, [editActionRef, itemsRef])\n  );\n\n  // Temp node when dragging in new objects\n  useRaf(\n    useCallback(() => {\n      if (tempItemRef.current != null && tempNode != null) {\n        const domElement = document.getElementById(tempNode.domId);\n        if (domElement != null) {\n          const styles = getStyles(tempItemRef.current);\n          for (const style in styles) {\n            (domElement.style as any)[style] = styles[style];\n          }\n        }\n      }\n    }, [tempNode, tempItemRef])\n  );\n\n  return (\n    <div\n      className={styles.container}\n      ref={containerRef}\n      onPointerDown={(e) => {\n        onEditStop(e);\n      }}\n    >\n      <div\n        className={styles.stage}\n        style={{\n          width: `${adjustedWidth}px`,\n          height: `${adjustedHeight}px`,\n        }}\n        ref={editorRef}\n      >\n        <div className={styles.background}>\n          {backgroundNodes.map((node) => node.element)}\n        </div>\n        <div\n          className={styles.foreground}\n          onPointerDown={(e) => {\n            onEditStop(e);\n          }}\n        >\n          {foregroundNodes.map((node) => node.element)}\n        </div>\n        {editNode}\n        {tempNode?.element}\n      </div>\n    </div>\n  );\n}\n","import { useCallback } from \"react\";\n\nimport { PomuBackground, PomuItemId, POMU_ITEMS } from \"./pomus/catalog\";\nimport { CursorEvent } from \"./types\";\n\nimport styles from \"./Toolbox.module.scss\";\n\nfunction Checkbox(props: {\n  checked: boolean;\n  setChecked: (checked: boolean) => void;\n}) {\n  const { checked, setChecked } = props;\n\n  return (\n    <input\n      type=\"checkbox\"\n      checked={checked}\n      onChange={(e) => setChecked(e.currentTarget.checked)}\n    />\n  );\n}\n\ninterface ToolboxProps {\n  availableItems: PomuItemId[];\n  clearAll: () => void;\n  onDragStart: (event: CursorEvent<HTMLDivElement>, id: PomuItemId) => void;\n  onEditStop: (event: CursorEvent<HTMLElement>) => void;\n  background: PomuBackground;\n  setBackground: (background: PomuBackground) => void;\n  snap: boolean;\n  setSnap: (snap: boolean) => void;\n}\n\nexport default function Toolbox(props: ToolboxProps): JSX.Element {\n  const {\n    availableItems,\n    onDragStart,\n    onEditStop,\n    background,\n    setBackground,\n    snap,\n    setSnap,\n    clearAll,\n  } = props;\n\n  const confirmClearAll = useCallback(() => {\n    const confirm = window.confirm(\n      \"Are you SURE you want to clear all the Pomus?\"\n    );\n    if (confirm) {\n      clearAll();\n    }\n  }, [clearAll]);\n  return (\n    <div className={styles.toolbox}>\n      <div className={styles.options}>\n        <label title=\"prior to the Fateful Findings watchalong stream\">\n          <Checkbox\n            checked={background === PomuBackground.CLASSIC}\n            setChecked={(checked: boolean) =>\n              setBackground(\n                checked ? PomuBackground.CLASSIC : PomuBackground.POMU_LOADING\n              )\n            }\n          />\n          Classic Background\n        </label>\n        <label>\n          <Checkbox checked={snap} setChecked={setSnap} />\n          Snap (shift)\n        </label>\n        <button onClick={confirmClearAll}>Clear all</button>\n      </div>\n      <div className={styles.itemsDrawer}>\n        <p>Click and drag into the editor</p>\n        {availableItems.map((id) => (\n          <div key={id} className={styles.item}>\n            <img\n              key={id}\n              src={POMU_ITEMS[id].src}\n              alt=\"\"\n              onPointerDown={(e) => {\n                onDragStart(e, id);\n                onEditStop(e);\n              }}\n              style={{ touchAction: \"none\" }}\n            />\n            <a href={POMU_ITEMS[id].source} target=\"_blank\" rel=\"noreferrer\">\n              source\n            </a>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n","import { MutableRefObject, RefObject, useCallback, useRef } from \"react\";\n\nimport { POMU_ITEMS } from \"./pomus/catalog\";\nimport { PomuItem } from \"./usePomuItems\";\nimport { CursorEvent } from \"./types\";\n\nexport type PomuEditType = \"select\" | \"translate\" | \"rotate\" | \"scale\";\n\nexport type PomuEditAction = {\n  index: number;\n  type: PomuEditType;\n  start: [number, number];\n  translateOffset: [number, number];\n  scaleCorner: [number, number];\n};\n\nconst ASPECT = 16 / 9;\nconst MIN_SCALE = 0.1;\n\nexport default function usePomuEditor(\n  editorRef: RefObject<HTMLDivElement>,\n  itemsRef: MutableRefObject<PomuItem[]>,\n  editItem: (index: number, update: Partial<PomuItem>) => void,\n  snap: boolean\n): {\n  onEditStart: (\n    event: CursorEvent<HTMLElement>,\n    index: number,\n    editType: PomuEditType\n  ) => void;\n  onEditMove: (event: CursorEvent<HTMLElement>) => void;\n  onEditEnd: (event: CursorEvent<HTMLElement>) => void;\n  onEditStop: (event: CursorEvent<HTMLElement>) => void;\n  editActionRef: MutableRefObject<PomuEditAction | null>;\n} {\n  const editActionRef = useRef<PomuEditAction | null>(null);\n\n  const onEditStart = useCallback(\n    (\n      event: CursorEvent<HTMLElement>,\n      index: number,\n      editType: PomuEditType\n    ) => {\n      if (editorRef.current == null) {\n        return;\n      }\n      const item = itemsRef.current[index];\n      if (item == null) {\n        return;\n      }\n\n      event.preventDefault();\n      event.stopPropagation();\n\n      const x = \"clientX\" in event ? event.clientX : event.touches[0].clientX;\n      const y = \"clientY\" in event ? event.clientY : event.touches[0].clientY;\n\n      const editorRect = editorRef.current.getBoundingClientRect();\n      const mouse: [number, number] = [\n        (x - editorRect.left) / editorRect.width,\n        (y - editorRect.top) / editorRect.height,\n      ];\n      const corner: [number, number] = [0, 0];\n      const translateOffset: [number, number] = [\n        mouse[0] - item.position[0],\n        mouse[1] - item.position[1],\n      ];\n      if (editType === \"scale\") {\n        const rotated = [\n          Math.cos(-item.rotation) * translateOffset[0] -\n            Math.sin(-item.rotation) * translateOffset[1],\n          Math.sin(-item.rotation) * translateOffset[0] +\n            Math.cos(-item.rotation) * translateOffset[1],\n        ];\n        const angle = Math.atan2(rotated[1], rotated[0]);\n        if (angle < -Math.PI / 2) {\n          corner[0] = -1;\n          corner[1] = -1;\n        } else if (angle < 0) {\n          corner[0] = 1;\n          corner[1] = -1;\n        } else if (angle < Math.PI / 2) {\n          corner[0] = 1;\n          corner[1] = 1;\n        } else {\n          corner[0] = -1;\n          corner[1] = 1;\n        }\n      }\n      // Mutate the existing ref if the index matches\n      if (editActionRef.current?.index === index) {\n        editActionRef.current.type = editType;\n        editActionRef.current.start = mouse;\n        editActionRef.current.translateOffset = translateOffset;\n        editActionRef.current.scaleCorner = corner;\n      } else {\n        editActionRef.current = {\n          index,\n          type: editType,\n          start: mouse,\n          translateOffset,\n          scaleCorner: corner,\n        };\n      }\n    },\n    [editorRef, itemsRef]\n  );\n\n  const onEditMove = useCallback(\n    (event: CursorEvent<HTMLElement>) => {\n      if (editorRef.current == null || editActionRef.current == null) {\n        return;\n      }\n      const item = itemsRef.current[editActionRef.current.index];\n      if (item == null) {\n        return;\n      }\n\n      event.stopPropagation();\n      event.preventDefault();\n\n      const x = \"clientX\" in event ? event.clientX : event.touches[0].clientX;\n      const y = \"clientY\" in event ? event.clientY : event.touches[0].clientY;\n\n      const editorRect = editorRef.current.getBoundingClientRect();\n      const shouldSnap = snap || event.shiftKey;\n      const mouse: [number, number] = [\n        (x - editorRect.left) / editorRect.width,\n        (y - editorRect.top) / editorRect.height,\n      ];\n      switch (editActionRef.current.type) {\n        case \"translate\":\n          let x = mouse[0] - editActionRef.current.translateOffset[0];\n          if (shouldSnap) {\n            x = (Math.round((x * 1920) / 32) * 32) / 1920;\n          }\n          let y = mouse[1] - editActionRef.current.translateOffset[1];\n          if (shouldSnap) {\n            y = (Math.round((y * 1080) / 32) * 32) / 1080;\n          }\n          editItem(editActionRef.current.index, {\n            position: [x, y],\n          });\n          break;\n        case \"scale\":\n          const def = POMU_ITEMS[item.id];\n          const offset = [\n            mouse[0] - item.position[0],\n            mouse[1] - item.position[1],\n          ];\n          let rotation =\n            Math.atan2(offset[1], offset[0] * ASPECT) -\n            Math.atan2(\n              editActionRef.current.scaleCorner[1] * def.size[1],\n              editActionRef.current.scaleCorner[0] * def.size[0] * ASPECT\n            );\n          if (shouldSnap) {\n            rotation = Math.round(rotation / (Math.PI / 36)) * (Math.PI / 36);\n          }\n          let scale = Math.max(\n            (Math.sqrt(\n              offset[0] * offset[0] * ASPECT * ASPECT + offset[1] * offset[1]\n            ) /\n              Math.sqrt(\n                def.size[0] * def.size[0] * ASPECT * ASPECT +\n                  def.size[1] * def.size[1]\n              )) *\n              2,\n            MIN_SCALE\n          );\n          if (shouldSnap) {\n            scale = Math.round(scale / MIN_SCALE) * MIN_SCALE;\n          }\n          editItem(editActionRef.current.index, {\n            rotation,\n            scale,\n          });\n          break;\n        default:\n          break;\n      }\n    },\n    [editorRef, editItem, itemsRef, snap]\n  );\n\n  const onEditEnd = useCallback((event: CursorEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (editActionRef.current == null) {\n      return;\n    }\n    editActionRef.current.type = \"select\";\n  }, []);\n\n  const onEditStop = useCallback((event: CursorEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    editActionRef.current = null;\n  }, []);\n\n  return { onEditStart, onEditMove, onEditEnd, onEditStop, editActionRef };\n}\n","import { useCallback, useEffect, useRef, useState } from \"react\";\n\nimport Header from \"./Header\";\nimport InfoModal from \"./InfoModal\";\nimport ShareModal from \"./ShareModal\";\nimport Stage from \"./Stage\";\nimport Toolbox from \"./Toolbox\";\nimport usePomuEditor from \"./usePomuEditor\";\nimport usePomuItems from \"./usePomuItems\";\nimport usePomuSettings from \"./usePomuSettings\";\nimport usePomuToolbox from \"./usePomuToolbox\";\n\nimport styles from \"./Editor.module.scss\";\n\ndeclare global {\n  interface Window {\n    POMU: any;\n  }\n}\n\nwindow.POMU = {};\n\nexport default function Editor(): JSX.Element {\n  const audio = useRef<HTMLAudioElement>(null);\n\n  const [audioPlaying, setAudioPlaying] = useState<boolean>(false);\n  const [audioVolume, setAudioVolume] = useState<number>(0.2);\n  const [infoModalOpen, setInfoModalOpen] = useState<boolean>(false);\n  const [shareModalOpen, setShareModalOpen] = useState<boolean>(false);\n\n  const editorRef = useRef<HTMLDivElement>(null);\n\n  const { background, setBackground, snap, setSnap } = usePomuSettings();\n  const { itemsRef, availableItems, addItem, editItem, deleteItem, clearAll } =\n    usePomuItems();\n  const {\n    onDragStart: onDragStartToolbox,\n    onDragMove: onDragMoveToolbox,\n    onDragStop: onDragStopToolbox,\n    tempItemRef,\n  } = usePomuToolbox(editorRef, addItem);\n  const { onEditStart, onEditMove, onEditEnd, onEditStop, editActionRef } =\n    usePomuEditor(editorRef, itemsRef, editItem, snap);\n\n  const playAudio = useCallback((): void => {\n    if (audio.current != null) {\n      audio.current.play();\n      setAudioPlaying(true);\n    }\n  }, []);\n\n  const pauseAudio = useCallback((): void => {\n    if (audio.current != null) {\n      audio.current.pause();\n      setAudioPlaying(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (audio.current != null) {\n      audio.current.volume = audioVolume;\n    }\n  }, [audioVolume]);\n\n  useEffect((): void => {\n    setInterval((): void => {\n      if (audio.current?.paused) {\n        setAudioPlaying(false);\n      } else {\n        setAudioPlaying(true);\n      }\n    }, 250);\n  }, []);\n\n  return (\n    <div\n      className={styles.editor}\n      onPointerMove={(e) => {\n        onDragMoveToolbox(e);\n        onEditMove(e);\n      }}\n      onPointerUp={(e) => {\n        onDragStopToolbox(e);\n        onEditEnd(e);\n      }}\n      onPointerLeave={(e) => {\n        onDragStopToolbox(e);\n        onEditEnd(e);\n      }}\n    >\n      <header>\n        <Header\n          audioPlaying={audioPlaying}\n          playAudio={playAudio}\n          pauseAudio={pauseAudio}\n          audioVolume={audioVolume}\n          setAudioVolume={setAudioVolume}\n          setInfoModalOpen={setInfoModalOpen}\n          setShareModalOpen={setShareModalOpen}\n        />\n      </header>\n      <main>\n        <div className={styles.stage}>\n          <Stage\n            editorRef={editorRef}\n            background={background}\n            itemsRef={itemsRef}\n            editActionRef={editActionRef}\n            tempItemRef={tempItemRef}\n            onEditStart={onEditStart}\n            onEditEnd={onEditEnd}\n            onEditStop={onEditStop}\n            deleteItem={deleteItem}\n          />\n        </div>\n        <div className={styles.toolbox}>\n          <Toolbox\n            availableItems={availableItems}\n            clearAll={clearAll}\n            onDragStart={onDragStartToolbox}\n            onEditStop={onEditStop}\n            background={background}\n            setBackground={setBackground}\n            snap={snap}\n            setSnap={setSnap}\n          />\n        </div>\n      </main>\n      <audio\n        autoPlay={true}\n        loop={true}\n        src={`${process.env.PUBLIC_URL}/media/sheep.mp3`}\n        ref={audio}\n      />\n      <InfoModal isOpen={infoModalOpen} setIsOpen={setInfoModalOpen} />\n      <ShareModal\n        isOpen={shareModalOpen}\n        setIsOpen={setShareModalOpen}\n        background={background}\n        itemsRef={itemsRef}\n      />\n    </div>\n  );\n}\n","import { useState } from \"react\";\n\nimport { PomuBackground } from \"./pomus/catalog\";\n\nexport default function usePomuSettings(): {\n  background: PomuBackground;\n  setBackground: (background: PomuBackground) => void;\n  snap: boolean;\n  setSnap: (snap: boolean) => void;\n} {\n  const [background, setBackground] = useState<PomuBackground>(\n    PomuBackground.CLASSIC\n  );\n  const [snap, setSnap] = useState<boolean>(false);\n\n  return { background, setBackground, snap, setSnap };\n}\n","import { MutableRefObject, RefObject, useCallback, useRef } from \"react\";\n\nimport { PomuItemId } from \"./pomus/catalog\";\nimport { PomuItem } from \"./usePomuItems\";\nimport { CursorEvent } from \"./types\";\n\nexport default function usePomuToolbox(\n  editorRef: RefObject<HTMLDivElement>,\n  addItem: (item: PomuItem) => void\n): {\n  onDragStart: (event: CursorEvent<HTMLElement>, id: PomuItemId) => void;\n  onDragMove: (event: CursorEvent<HTMLElement>) => void;\n  onDragStop: (event: CursorEvent<HTMLElement>) => void;\n  tempItemRef: MutableRefObject<PomuItem | null>;\n} {\n  const tempItemRef = useRef<PomuItem | null>(null);\n\n  const onDragStart = useCallback(\n    (event: CursorEvent<HTMLElement>, id: PomuItemId) => {\n      if (editorRef.current == null) {\n        return;\n      }\n      event.stopPropagation();\n      event.preventDefault();\n\n      const x = \"clientX\" in event ? event.clientX : event.touches[0].clientX;\n      const y = \"clientY\" in event ? event.clientY : event.touches[0].clientY;\n\n      const editorRect = editorRef.current.getBoundingClientRect();\n      tempItemRef.current = {\n        id,\n        position: [\n          (x - editorRect.left) / editorRect.width,\n          (y - editorRect.top) / editorRect.height,\n        ],\n        rotation: 0,\n        scale: 1,\n      };\n    },\n    [editorRef]\n  );\n\n  const onDragMove = useCallback(\n    (event: CursorEvent<HTMLElement>) => {\n      if (editorRef.current == null || tempItemRef.current == null) {\n        return;\n      }\n      event.stopPropagation();\n      event.preventDefault();\n\n      const x = \"clientX\" in event ? event.clientX : event.touches[0].clientX;\n      const y = \"clientY\" in event ? event.clientY : event.touches[0].clientY;\n\n      const editorRect = editorRef.current.getBoundingClientRect();\n      tempItemRef.current.position[0] =\n        (x - editorRect.left) / editorRect.width;\n      tempItemRef.current.position[1] =\n        (y - editorRect.top) / editorRect.height;\n    },\n    [editorRef]\n  );\n\n  const onDragStop = useCallback(\n    (event: CursorEvent<HTMLElement>) => {\n      if (editorRef.current == null || tempItemRef.current == null) {\n        return;\n      }\n      const x = \"clientX\" in event ? event.clientX : event.touches[0].clientX;\n      const y = \"clientY\" in event ? event.clientY : event.touches[0].clientY;\n\n      const editorRect = editorRef.current.getBoundingClientRect();\n      if (\n        editorRect.left <= x &&\n        x <= editorRect.right &&\n        editorRect.top <= y &&\n        y <= editorRect.bottom\n      ) {\n        addItem(tempItemRef.current);\n      }\n      tempItemRef.current = null;\n    },\n    [editorRef, addItem]\n  );\n\n  return { onDragStart, onDragMove, onDragStop, tempItemRef };\n}\n","import useSize from \"@react-hook/size\";\nimport gsap from \"gsap\";\nimport { useEffect, useMemo, useRef } from \"react\";\n\nimport { MakeTimelineFn, PomuBackground, POMU_ITEMS } from \"./pomus/catalog\";\nimport { makeBackground, PomuItem } from \"./usePomuItems\";\n\nimport styles from \"./Stage.module.scss\";\n\nfunction getStyles(item: PomuItem): Record<string, string> {\n  const def = POMU_ITEMS[item.id];\n  return {\n    width: `${def.size[0] * item.scale * 100}%`,\n    height: `${def.size[1] * item.scale * 100}%`,\n    left: `${item.position[0] * 100}%`,\n    top: `${item.position[1] * 100}%`,\n    transform: `translate(-50%, -50%) rotate(${item.rotation}rad)`,\n  };\n}\n\ntype RenderedNode = {\n  domId: string;\n  element: JSX.Element;\n  timelineFn: MakeTimelineFn | null;\n};\n\ninterface StageProps {\n  background: PomuBackground;\n  items: PomuItem[];\n}\n\nexport default function Stage(props: StageProps): JSX.Element {\n  const { background, items } = props;\n\n  const timeline = useRef<gsap.core.Timeline>(new gsap.core.Timeline());\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const [width, height] = useSize(containerRef);\n\n  const [adjustedWidth, adjustedHeight] = useMemo(() => {\n    if (width / height > 16 / 9) {\n      return [(height * 16) / 9, height];\n    } else {\n      return [width, (width * 9) / 16];\n    }\n  }, [width, height]);\n\n  const backgroundNodes = useMemo((): RenderedNode[] => {\n    const bgItems = makeBackground(background);\n\n    return bgItems.flatMap((item, itemIndex) => {\n      return item.group.map((object, objectIndex) => {\n        const id = `bg-${itemIndex}-${objectIndex}`;\n        return {\n          domId: id,\n          element: (\n            <div\n              key={id}\n              id={id}\n              className={styles.backgroundObject}\n              {...object.props}\n            >\n              <img src={object.src} alt=\"Pomu\" />\n            </div>\n          ),\n          timelineFn: object.makeTimeline,\n        };\n      });\n    });\n  }, [background]);\n\n  const foregroundNodes = useMemo((): RenderedNode[] => {\n    return items.flatMap((item, itemIndex) => {\n      const id: string = `fg-${itemIndex}`;\n      return {\n        domId: id,\n        element: (\n          <div\n            key={id}\n            id={id}\n            className={styles.foregroundObject}\n            style={{ ...getStyles(item) }}\n          >\n            <img src={POMU_ITEMS[item.id].src} alt=\"Pomu\" />\n          </div>\n        ),\n        timelineFn: null,\n      };\n    });\n  }, [items]);\n\n  useEffect(() => {\n    timeline.current.clear();\n    for (const node of backgroundNodes) {\n      if (node.timelineFn != null) {\n        timeline.current.add(node.timelineFn(`#${node.domId}`), 0);\n      }\n    }\n    for (const node of foregroundNodes) {\n      if (node.timelineFn != null) {\n        timeline.current.add(node.timelineFn(`#${node.domId}`), 0);\n      }\n    }\n  }, [backgroundNodes, foregroundNodes]);\n\n  return (\n    <div className={styles.container} ref={containerRef}>\n      <div\n        className={styles.stage}\n        style={{\n          width: `${adjustedWidth}px`,\n          height: `${adjustedHeight}px`,\n        }}\n      >\n        <div className={styles.background}>\n          {backgroundNodes.map((node) => node.element)}\n        </div>\n        <div className={styles.foreground}>\n          {foregroundNodes.map((node) => node.element)}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\n\nimport InfoModal from \"./InfoModal\";\nimport Header from \"./Header\";\nimport * as PomuSerdes from \"./PomuSerdes\";\nimport { PomuBackground } from \"./pomus/catalog\";\nimport { PomuItem } from \"./usePomuItems\";\nimport ReadonlyStage from \"./ReadonlyStage\";\n\nimport styles from \"./Editor.module.scss\";\n\nexport default function Viewer() {\n  const params = useParams();\n\n  const audio = useRef<HTMLAudioElement>(null);\n  const main = useRef<HTMLDivElement>(null);\n\n  const [audioPlaying, setAudioPlaying] = useState<boolean>(false);\n  const [audioVolume, setAudioVolume] = useState<number>(0.2);\n  const [infoModalOpen, setInfoModalOpen] = useState<boolean>(false);\n\n  const [background, setBackground] = useState<PomuBackground>(\n    PomuBackground.CLASSIC\n  );\n  const [items, setItems] = useState<PomuItem[]>([]);\n\n  useEffect(() => {\n    try {\n      const { background, items } = PomuSerdes.deserialize(params[\"*\"] ?? \"\");\n      setBackground(background);\n      setItems(items);\n    } catch (err) {\n      // TODO show error\n    }\n  }, [params]);\n\n  const playAudio = useCallback((): void => {\n    if (audio.current != null) {\n      audio.current.play();\n      setAudioPlaying(true);\n    }\n  }, []);\n\n  const pauseAudio = useCallback((): void => {\n    if (audio.current != null) {\n      audio.current.pause();\n      setAudioPlaying(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (audio.current != null) {\n      audio.current.volume = audioVolume;\n    }\n  }, [audioVolume]);\n\n  useEffect((): void => {\n    setInterval((): void => {\n      if (audio.current?.paused) {\n        setAudioPlaying(false);\n      } else {\n        setAudioPlaying(true);\n      }\n    }, 250);\n  }, []);\n\n  return (\n    <div className={styles.editor}>\n      <header>\n        <Header\n          audioPlaying={audioPlaying}\n          playAudio={playAudio}\n          pauseAudio={pauseAudio}\n          audioVolume={audioVolume}\n          setAudioVolume={setAudioVolume}\n          setInfoModalOpen={setInfoModalOpen}\n        />\n      </header>\n      <main ref={main}>\n        <div className={styles.stage}>\n          <ReadonlyStage background={background} items={items} />\n        </div>\n      </main>\n      <audio\n        autoPlay={true}\n        loop={true}\n        src={`${process.env.PUBLIC_URL}/media/sheep.mp3`}\n        ref={audio}\n      />\n      <InfoModal isOpen={infoModalOpen} setIsOpen={setInfoModalOpen} />\n    </div>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { HashRouter, Route, Routes } from \"react-router-dom\";\n\nimport Editor from \"./Editor\";\nimport Viewer from \"./Viewer\";\n\nimport \"./index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter>\n      <Routes>\n        <Route path=\"/\" element={<Editor />} />\n        <Route path=\"/edit\" element={<Editor />} />\n        <Route path=\"/view/*\" element={<Viewer />} />\n      </Routes>\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"draggable\":\"Stage_draggable__34P_s\",\"container\":\"Stage_container__-HPHU\",\"stage\":\"Stage_stage__ZtVbE\",\"background\":\"Stage_background__3IUON\",\"foreground\":\"Stage_foreground__3VOh_\",\"backgroundObject\":\"Stage_backgroundObject__7ji0r\",\"foregroundObject\":\"Stage_foregroundObject__1eXHJ\",\"tempObject\":\"Stage_tempObject__xSiol\",\"editKnobs\":\"Stage_editKnobs__2jPV1\",\"scale\":\"Stage_scale__29GAg\",\"rotate\":\"Stage_rotate__LZ18p\",\"delete\":\"Stage_delete__3k8Z2\",\"corner0\":\"Stage_corner0__1S4xz\",\"corner1\":\"Stage_corner1__3ju8F\",\"corner2\":\"Stage_corner2__yMrs2\",\"corner3\":\"Stage_corner3__1Z7Gq\"};"],"sourceRoot":""}